# Forms & User Input

-   Most web applications are mostly forms
-   The most difficult part is to provide feedback to the user
-   Form can have multiple states, beyond valid and invalid
-   Forms also need multiple validations
    -   When a form is submitted
        -   Wait until is done before warning their
        -   Avoid unnecessary warnings
    -   When the input looses focus
        -   Allows to enter a valid value before warning
    -   On every keystroke
        -   Direct feedback on input

## Input values

-   Can be handled as state or as values, it depends on what do you want to do with them
-   If you need to do something with the value on every keystroke value is better choice
-   If you just need to send the final output you might go with ref
-   The main idea is to let React manipulate the DOM, avoiding the use of `inputRef.current?.value` is a better practice

    ```TSX
    // Ref
    const SimpleInput = () => {
        const inputRef = useRef<HTMLInputElement>(null),
            handleNameChange = () => {
                console.log(inputRef.current?.value); // NOT RECOMMENDED
            },
            submitHandler: FormEventHandler<HTMLFormElement> = (event: FormEvent) => {
                event.preventDefault();
                const inputValue = inputRef.current?.value;
            };

        return (
            <form onSubmit={submitHandler}>
                <label htmlFor='name'>Your Name</label>
                <input type='text' id='name' onChange={handleNameChange} ref={inputRef} />
                <button>Submit</button>
            </form>
        );
    };
    ```

    ```TSX
    const BasicForm = () => {
        const [enteredName, setEnteredName] = useState<string>(""),
            nameInputChangeHandler: ChangeEventHandler<HTMLInputElement> = (event: ChangeEvent<HTMLInputElement>) => {
                setEnteredName(event.target.value);
            },
            submitHandler: FormEventHandler<HTMLFormElement> = (event: FormEvent) => {
               event.preventDefault();
            };

        return (
            <form onSubmit={submitHandler}>
                <label htmlFor='name'>First Name</label>
                <input type='text' id='name' onChange={nameInputChangeHandler} value={enteredName} />
                <button>Submit</button>
            </form>
        );
    };
    ```

## Validation

-   In the frontend is always useful for user experience
-   It always need to have server validation to avoid security issues
-   Focus and blur are two very important events as well for validations, they can help you to set valid or invalid fields right after the input is focused and not before

    ```TSX
    import { useState, ChangeEventHandler, FormEventHandler, FormEvent, ChangeEvent } from "react";
    import clsx from "clsx";
    import { nameInputValidator } from "utils/validators";

    const SimpleInput = (): JSX.Element => {
        // State variables for name input and validation
        const [nameInput, setNameInput] = useState<string>('');
        const [nameInputIsValid, setNameInputIsValid] = useState<boolean>(false);
        const [nameIsTouched, setNameIsTouched] = useState<boolean>(false);
        const [errorMessage, setErrorMessage] = useState<string>('');

        // Function to check if name input is invalid
        const nameInputIsInvalid = (): boolean => !nameInputIsValid && nameIsTouched;

        // Function to validate the name input
        const validateNameInput = (): void => {
            if (!nameInput.trim()) {
                setErrorMessage('Please enter a name');
            } else if (!nameInputIsValid) {
                setErrorMessage('Please enter a valid name');
            } else {
                setErrorMessage('');
            }
        };

        // Event handler for name input change
        const handleNameChange: ChangeEventHandler<HTMLInputElement> = (event: ChangeEvent<HTMLInputElement>) => {
            setNameInput(event.target?.value);
            setNameIsTouched(false);
            setNameInputIsValid(nameInputValidator(event.target?.value));
        };

        // Event handler for name input blur
        const handleNameBlur: FocusEventHandler<HTMLInputElement> = (_: FocusEvent<HTMLInputElement>) => {
            setNameIsTouched(true);
            validateNameInput();
        };

        // Event handler for form submission
        const submitHandler: FormEventHandler<HTMLFormElement> = (event: FormEvent) => {
            event.preventDefault();
            setNameIsTouched(true);
            validateNameInput();
            if (!nameInputIsInvalid()) {
                // Do something when submit
                console.log(nameInput);
            }
        };

        return (
            <form onSubmit={submitHandler}>
                <div className={clsx('form-control', {
                    invalid: nameInputIsInvalid(),
                })}>
                    <label htmlFor='name'>Your Name</label>
                    <input
                        type='text'
                        id='name'
                        onChange={handleNameChange}
                        onBlur={handleNameBlur}
                        value={nameInput}
                        minLength={2}
                        maxLength={255}
                    />
                    {nameInputIsInvalid() && <p className="error-text">{errorMessage}</p>}
                </div>
                <div className="form-actions">
                    <button>Submit</button>
                </div>
            </form >
        );
    };

    export default SimpleInput;
    ```
