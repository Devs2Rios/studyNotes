# React Router

-   Routing: Different URL paths load different things
-   On static websites it was achieved by sending a different `HTML` files when a different route was used
-   React can handle URL changes with client side code without fetching a new `HTML`

## Setup

-   On an existing app install [the package](https://reactrouter.com/en/main/start/tutorial)
    ```SHELL
    npm install react-router-dom
    ```
-   Then we'll need to configure our `Router`

    ```TSX
    import { createBrowserRouter, RouterProvider } from "react-router-dom";
    import Home from "./pages/Home";
    import Artists from "./pages/Artists";
    import NotFound from "./pages/NotFound";

    // First we need to configure our routes.
    // We use createBrowserRouter() to create a router with a list of routes.
    const router = createBrowserRouter([
        {
            path: "/", element: <Home />,
        },
        {
            path: "/artists", element: <Artists />,
        },
    ]);

    // And with the RouterProvider we inject our routes to our App
    export default function App(): JSX.Element {
        return (
            <RouterProvider router={router} />
        );
    }
    ```

-   Alternatively you can create routes using JSX

    ```JSX
    const routeDefinitions = createRoutesFromElements(
        <Route>
            <Route path="/" element={<Home />} />
        </Route>
    )
    const router = createBrowserRouter(routeDefinitions);
    export default function App(): JSX.Element {
        return (
            <RouterProvider router={router} />
        );
    }
    ```

## Features

-   Route navigation

    -   Don't use `<a>` since affects perfonmance by sending a new `HTTP` request
    -   Use the `<Link>` component to navigate between pages instead

        ```TSX
        import { Link } from "react-router-dom";

        export default function Home(): JSX.Element {
            return (
                <>
                    <h1>Home</h1>
                    <p>Go to <Link to="/artists">Artists</Link> page</p>
                </>
            );
        }
        ```

    -   Nesting routes:

        ```TSX
        // Layout
        import { Outlet } from 'react-router-dom';
        import Nav from './Nav';

        // The outlet element will allow us to add dynamic routing maintainig other components in the layout
        export default function Layout() {
            return (
                <>
                    <Nav />
                    <Outlet />
                </>
            );
        }
        ```

        ```TSX
        import { createBrowserRouter, RouterProvider } from "react-router-dom";
        import Home from "./pages/Home";
        import Artists from "./pages/Artists";
        import NotFound from "./pages/NotFound";
        import Layout from "./components/Layout";
        // Now we can nest the routes inside the parent element with the <Outlet />
        const router = createBrowserRouter([
        {
            path: "/",
            element: <Layout />,
            errorElement: <NotFound /> // This element is a fallback when a route is not found
            children: [
                {
                    path: "/", element: <Home />,
                },
                {
                    path: "/artists", element: <Artists />,
                },
            ]
        },
        ]);

        export default function App(): JSX.Element {
        return (
            <RouterProvider router={router} />
        );
        }
        ```

    -   Active links can be modified with the `isActive` property, both in classes and styles

        ```JSX
        <NavLink to="/" className={({ isActive }) => isActive ? 'active' : undefined} aria-current="page">Home</NavLink>
        ```

    -   Imperative routing can be handled using the `useNavigate()` hook

        ```TSX
        import { useNavigate } from "react-router-dom";

        export default function Home(): JSX.Element {
            const navigate = useNavigate(),
                handleNavigate = () => navigate('/artists');

            return (
                <>
                    <h1>Home</h1>
                    {/* Just for demonstration, it's better to use Link */}
                    <button onClick={handleNavigate}>Artists</button>
                </>
            );
        }
        ```

    -   Dynamic routing

        -   `App.tsx` configuration

            ```TSX
            import { createBrowserRouter, RouterProvider } from "react-router-dom";
            import Home from "./pages/Home";
            import Artists from "./pages/Artists";
            import Artist from "./pages/Artist";
            import NotFound from "./pages/NotFound";
            import Layout from "./components/Layout";

            const router = createBrowserRouter([
            {
                path: "/", element: <Layout />,
                errorElement: <NotFound />,
                children: [
                    { path: "/", element: <Home /> },
                    { path: "/artists", element: <Artists /> },
                    { path: "/artists/:artistId", element: <Artist /> },
                    // :{myParam} is the identifier of the dynamic route
                ]
            },
            ]);

            export default function App(): JSX.Element {
            return (
                <RouterProvider router={router} />
            );
            }
            ```

        -   Dynamic route component

            ```TSX
            import artists from "../assets/artists";
            import { useState } from "react";
            import { useParams } from "react-router-dom";
            import { Artist } from "../types";

            export default function ArtistPage(): JSX.Element {
                // An object with every dynamic path section
                const { artistId } = useParams<{ artistId: string; }>(),
                    [artist] = useState<Artist | undefined>(
                        artists.find((artist: Artist) => artist.id === (artistId ? +artistId : 0))
                    );

                if (!artist) {
                    return (
                        <>
                            <h1>Artist not found</h1>
                            <p>The artist you are looking for does not exist.</p>
                        </>
                    );
                }

                return (
                    <>
                        <h1>{artist.name}</h1>
                        <p>An artist from {artist.country}</p>
                    </>
                );
            }
            ```

    -   Dynamic Route Navigation

        ```TSX
        import ARTISTS from "../assets/artists";
        import ArtistDetail from "../components/ArtistDetail";

        export default function Home(): JSX.Element {
            return (
                <>
                    <h1>Artists</h1>
                    <ul>
                        {ARTISTS.map(artist => <ArtistDetail key={`artist-${artist.id}`} id={artist.id} name={artist.name} country={artist.country} />)}
                    </ul>
                </>
            );
        }
        ```

        ```TSX
        import { Link } from "react-router-dom";

        interface ArtistDetailProps {
            id: number;
            name: string;
            country: string;
        }

        export default function ArtistDetail({ id, name, country }: ArtistDetailProps): JSX.Element {
            return (
                <li>
                    <Link to={`/artists/${id}`}>
                        <span>{name}</span> - <span className="italic text-green-500">{country}</span>
                    </Link>
                </li>
            );
        }
        ```

    -   Relative and absolute paths

        -   Absolute paths start with `/`
        -   Relative paths start with nothing, in a nested scenario would be this way
            ```SHELL
            /abs-pat
                about -> Relative to abs-path -> /abs-pat/about
            ```
        -   In navigation this is very powerfull because it will allow is to handle parameters more easily

            ```TSX
            import { Link } from "react-router-dom";

            interface ArtistDetailProps {
                id: number;
                name: string;
                country: string;
            }

            export default function ArtistDetail({ id, name, country }: ArtistDetailProps): JSX.Element {
                return (
                    <li>
                        {/* This will got to /artists/:id */}
                        <Link to={`${id}`}>
                        {/* You can specify which relation to adopt with the attribute relative using "path" or "route" */}
                            <span>{name}</span> - <span className="italic text-green-500">{country}</span>
                        </Link>
                    </li>
                );
            }
            ```

        -   Links can also return to a previous active page using `..`
            ```TSX
            if (!artist) {
                return (
                    <>
                        <h1>Artist not found</h1>
                        <p>The artist you are looking for does not exist.</p>
                        <Link to="..">Go back home</Link> {/* Back to home */}
                        <Link to=".." relative="path">Go back to artists</Link> {/* Back to /artists */}
                    </>
                );
            }
            ```

    -   Index routes are the default values for a determined route

        ```TS
        const router = createBrowserRouter([
            {
                path: "/", element: <Layout />,
                errorElement: <NotFound />,
                children: [
                    { index: true, element: <Home /> },
                    { path: "artists", element: <Artists /> },
                    { path: "artists/:artistId", element: <Artist /> },
                ]
            },
        ]);
        ```
